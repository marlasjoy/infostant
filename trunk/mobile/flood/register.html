<html><head>
<meta content="initial-scale=1.0, user-scalable=no" name="viewport">
         <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>PhoneGap</title>
        <link type="text/css" rel="stylesheet" href="http://code.google.com/apis/maps/documentation/javascript/examples/default.css">  
        <script type="text/javascript" charset="utf-8" src="phonegap-1.2.0.js"></script>
        <script src="http://maps.googleapis.com/maps/api/js?sensor=false" type="text/javascript"></script>
        <link rel="stylesheet" href="jquery.mobile-1.0rc2/jquery.mobile-1.0rc2.min.css" /> 
         <script src="cookie.js"></script> 
        <script src="jquery-1.6.4.min.js"></script> 
         <script>
         var pictureSource;   // picture source
         var destinationType; // sets the format of returned value  
         var imageURI="";
         var webdir="http://www.infostant.com";
         document.addEventListener("deviceready", onDeviceReady, false);  
             function PictureSourceType() {};
             PictureSourceType.PHOTO_LIBRARY = 0;
             PictureSourceType.CAMERA = 1;

               function reachableCallback(reachability) {
                 
                 // There is no consistency on the format of reachability
                 
                 var networkState = reachability.code || reachability;
                 
                 var states = {};
                 
                 states[NetworkStatus.NOT_REACHABLE]                      = 'No network connection';
                 
                 states[NetworkStatus.REACHABLE_VIA_CARRIER_DATA_NETWORK] = 'Carrier data connection';
                 
                 states[NetworkStatus.REACHABLE_VIA_WIFI_NETWORK]         = 'WiFi connection';
                 
                // navigator.notification.alert('Connection type: ' + states[networkState]);
                 
             }
              function responseformserver(myObject)
             {
                 navigator.notification.alert(myObject.title); 
             }

            
             function submittoserver() {
                 
                   var errorcode=''; 
                     if($('#userid').val()=="")
                     {
                        if($('#email').val()=="")
                         {
 
                          errorcode='โปรดกรอก Email';  
                         } 
                        else if($('#username').val()=="")
                         {
 
                          errorcode='โปรดกรอก Username';  
                         }
                        else  if($('#password1').val()=="")
                         {
                          errorcode='โปรดกรอก Password';    
                         }
                        else if($('#repassword').val()=="")
                         {
                          errorcode='โปรดกรอก Password อีกครั้ง';    
                         }
                        else if($('#repassword').val()!=$('#password1').val())
                         {
                          errorcode='โปรดกรอก Password ให้ตรงกัน';   
                         }

                     }else if($('#namepost').val()=="")
                         {
                          errorcode='โปรดกรอก ผู้ติดต่อ';  
                         }
                       else  if($('#shopname').val()=="")
                         {
                          errorcode='โปรดกรอก ชื่อวัด หรือ โรงเรียน';    
                         }
                       else  if($('#shopurl').val()=="")
                         {
                          errorcode='โปรดกรอก ชื่อ URL';    
                         }

                      else   if($('#title').val()=="")
                         {
                          errorcode='โปรดกรอก หัวข้อ';    
                         }
                      else   if($('#description').val()=="")
                         {
                          errorcode='โปรดกรอก ระบายความในใจ';    
                         }
                     else    if($('#address').val()=="")
                         {
                          errorcode='โปรดกรอก ที่อยู่';    
                         }
                     else     if($('#province').val()=="")
                         {
                          errorcode='โปรดกรอก จังหวัด';    
                         }
                    else      if($('#district').val()=="")
                         {
                          errorcode='โปรดกรอก อำเภอ';    
                         }
                   else      if($('#tumbon').val()=="")
                         {
                          errorcode='โปรดกรอก ตำบล';    
                         }
                    else     if($('#postcode').val()=="")
                         {
                          errorcode='โปรดกรอก รหัสไปรษณีย์';    
                         }
                   else      if($('#tel').val()=="")
                         {
                          errorcode='โปรดกรอก เบอร์โทรศัพท์';    
                         }
                   else      if($('#emailshop').val()=="")
                         {
                          errorcode='โปรดกรอก email ของผู้ติดต่อ';    
                         }
                    else     if($('#daterange').val()=="")
                         {
                          errorcode='โปรดกรอก  วันเวลาที่เปิดทำการ';    
                         }
                       
                         
                         if(errorcode!="")
                         {
                             navigator.notification.alert(errorcode); 
                             return false;
                         } 
                         else if(errorcode==""){
                     $.post(webdir+'/ajax/submitformiphone',{
                     pic1:imageURI 
                     ,email:$('#email').val()
                     ,username:encodeURIComponent($('#username').val())
                     ,password1:encodeURIComponent($('#password1').val())
                     ,repassword:encodeURIComponent($('#repassword').val()) 
                     ,namepost:encodeURIComponent($('#namepost').val())
                     ,shopname:encodeURIComponent($('#shopname').val())   
                     ,shopurl:$('#shopurl').val()   
                     ,website:encodeURIComponent($('#website').val())   
                     ,title:encodeURIComponent($('#title').val()) 
                     ,description:encodeURIComponent($('#description').val())  
                     ,address:encodeURIComponent($('#address').val())  
                     ,province:encodeURIComponent($('#province').val())  
                     ,district:encodeURIComponent($('#district').val())  
                     ,tumbon:encodeURIComponent($('#tumbon').val())  
                     ,postcode:encodeURIComponent($('#postcode').val())  
                     ,tel:encodeURIComponent($('#tel').val()) 
                     ,emailshop:$('#emailshop').val()
                     ,daterange:encodeURIComponent($('#daterange').val())  
                     ,lat:$('#lat').val()  
                     ,lng:$('#lng').val()  
                     ,cat:$('#cat').val() 
                     ,subcat:$('#subcat').val()
                     ,userid:$('#userid').val()       
                     }, function(data) {
                           var myObject = eval('(' + data + ')');
                         //  $('#buttonSave').attr("disabled", "true");
                           $('#buttonSave').val('กำลังบันทึก...');
                           if(myObject.error)
                           {
                                 navigator.notification.alert(myObject.error);
                              //    $('#buttonSave').attr("disabled", "false"); 
                                // return false;
                           }else  if(myObject.shopurl)
                           {
                               if(!checkCookie('username')){
                               setCookie('username',myObject.username,36500000);
                               setCookie('userid',myObject.mid,36500000);  
                               }
                               navigator.notification.alert('บันทึกข้อมูลเรียบร้อยแล้ว');  
                               location.href="flood.html?shopurl="+myObject.shopurl;
                           }
//
                            });
                     
                         }
                 
             }
             function win(r) {
                 navigator.notification.alert("Code = " + r.responseCode);
                 navigator.notification.alert("Response = " + r.response);
             }
             
             // Error reporting
             function fail(message) {
                 navigator.notification.alert('Failed because: ' + message);
             }
             
             // PhoneGap is loaded and it is now safe to make calls PhoneGap methods
             
             function onDeviceReady() {
                 //?navigator.notification.alert('');  
                 navigator.network.isReachable('phonegap.com', reachableCallback);
                 pictureSource=navigator.camera.PictureSourceType;
                 destinationType=navigator.camera.DestinationType;
                 
             }
             $( function() {
               
               $('#searchButton').click(function() {
                                        loadajax();
                                        });
               $('#search2Button').click(function() {
                                         $('.ui-listview').html('');
                                         $('#searchBox').val(''); 
                                         });                         
               $('#recentButton').click(function() {
                                        $('#searchBox').val('');
                                        loadajax();
                                        });                         
               
               
               
               });
             function getPicture(sourceType)
             {
                 var options = { quality: 30 };
                 if (sourceType != undefined) {
                     options["sourceType"] = sourceType;
                     
                 }
                 // if no sourceType specified, the default is CAMERA 
                 navigator.camera.getPicture(getPicture_Success, onFail, options);
             }
             function getPicture_Success(imageData)
             {
                 imageURI=imageData;
                 //alert("getpic success");
                 document.getElementById("test_img").src = "data:image/jpeg;base64," + imageData;
                 
                 
             }
             function capturePhoto() {
                 // Take picture using device camera and retrieve image as base64-encoded string
                 navigator.camera.getPicture(getPicture_Success, onFail, { quality: 50 });
             }
             function onFail(message) {
                 navigator.notification.alert('Failed because: ' + message);
             }

             $(document).ready(function() {
             // Handler for .ready() called.
              if(checkCookie('userid'))
              {
                $("#userid").val(getCookie('userid'));  
                 $("#member1").hide();  
              }else
              {
                  $("#member1").show();
              }
              
            //  alert(getCookie('userid'));  
             });

     
         </script>
        <script src="jquery.mobile-1.0rc2/jquery.mobile-1.0rc2.min.js"></script>
        
        <script src="flood.js"></script> 
        <script src="register.js"></script> 
        <script src="googlemap.js"></script>
        
    </head>
    
    <body onload="initialize();">
                      <header>
                      </header> 
           <article>             
          <div data-role="page" id="register"> 
            
            <div data-role="header" data-position="fixed"> 
                
                <h1>สมัครสมาชิก</h1> 
                <a href="javascript:void(0);" onclick="location.href='index.html'" id="recentButton" data-role="button">กลับไปหน้าหลัก</a> 
                
              
                
            </div>
            
            <div data-role="content"> 

                  <div class="content-primary">
                  <form name="registersummit" id="registersummit" onsubmit="return submittoserver()">
                  
                  <div id="member1" class="ui-body ui-body-c">
                <h2>Member Information</h2>
                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                 <label for="name-c" class="ui-input-text">อีเมล์:</label>
                 <input type="text" value="" id="email" name="email" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset">
                </div>

                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">ชื่อสมาชิก</label>
                    <input type="text" value="" id="username" name="username" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset">  
                </div>
                
                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">รหัสผ่าน</label>
                    <input type="password" value="" id="password1" name="password1" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset">  
                </div>
                
                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">ยืนยันรหัสผ่าน</label>
                    <input type="password" value="" id="repassword" name="repassword" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset">  
                </div>

                </div> 
                 <div class="ui-body ui-body-b">
                <h2>ข้อมูลสถานที่ ที่ต้องการความช่วยเหลือ (Location Information)</h2>

                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">ชื่อผู้ติดต่อ</label>
                    <input type="text" value="" id="namepost" name="namepost" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset">  
                </div>
                
                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">โรงเรียน / วัด </label>
                    <input type="text" value="" id="shopname" name="shopname" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset">  
                </div>
                
                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">ชื่อ URL  </label>
                    <input type="text" value="" id="shopurl" name="shopurl" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset">  
                </div>
                
                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">Website  </label>
                    <input type="text" value="" id="website" name="website" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset">  
                </div>
                
                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">หัวข้อ </label>
                    <input type="text" value="" id="title" name="title" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset">  
                </div>
                
                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">บรรยายความในใจ   </label>
                    <textarea id="description" name="description" rows="8" cols="40" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset"></textarea>
                </div>
                
                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">ที่อยู่ </label>
                    <textarea id="address" name="address" rows="8" cols="40" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset"></textarea>
                </div>
                

            



                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">   
                    <label class="select ui-select" for="select-choice-c">จังหวัด:</label>
                    <div class="ui-select">
                    <select size="1" name="province" id="province">

                    <option value="" selected="">กรุณาเลือกจังหวัด</option>
                    <option value="101">กระบี่</option>
                    <option value="102">กรุงเทพมหานคร</option>
                    <option value="103">กาญจนบุรี</option>
                    <option value="104">กาฬสินธุ์</option>
                    <option value="105">กำแพงเพชร</option>
                    <option value="106">ขอนแก่น</option>
                    <option value="107">จันทบุรี</option>
                    <option value="108">ฉะเชิงเทรา</option>
                                                      <option value="109">ชลบุรี</option>
                                                      <option value="110">ชัยนาท</option>
                                                      <option value="111">ชัยภูมิ</option>
                                                      <option value="112">ชุมพร</option>
                                                      <option value="113">ตรัง</option>
                                                      <option value="114">ตราด</option>
                                                      <option value="115">ตาก</option>
                                                      <option value="116">นครนายก</option>
                                                      <option value="117">นครปฐม</option>
                                                      <option value="118">นครพนม</option>
                                                      <option value="119">นครราชสีมา</option>
                                                      <option value="120">นครศรีธรรมราช</option>
                                                      <option value="121">นครสวรรค์</option>
                                                      <option value="122">นนทบุรี</option>
                                                      <option value="123">นราธิวาส</option>
                                                      <option value="124">น่าน</option>
                                                      <option value="125">บุรีรัมย์</option>
                                                      <option value="126">ปทุมธานี</option>
                                                      <option value="127">ประจวบคีรีขันธ์</option>
                                                      <option value="128">ปราจีนบุรี</option>
                                                      <option value="129">ปัตตานี</option>
                                                      <option value="130">พระนครศรีอยุธยา</option>
                                                      <option value="131">พะเยา</option>
                                                      <option value="132">พังงา</option>
                                                      <option value="133">พัทลุง</option>
                                                      <option value="134">พิจิตร</option>
                                                      <option value="135">พิษณุโลก</option>
                                                      <option value="136">ภูเก็ต</option>
                                                      <option value="137">มหาสารคาม</option>
                                                      <option value="138">มุกดาหาร</option>
                                                      <option value="139">ยะลา</option>
                                                      <option value="140">ยโสธร</option>
                                                      <option value="141">ระนอง</option>
                                                      <option value="142">ระยอง</option>
                                                      <option value="143">ราชบุรี</option>
                                                      <option value="144">ร้อยเอ็ด</option>
                                                      <option value="145">ลพบุรี</option>
                                                      <option value="146">ลำปาง</option>
                                                      <option value="147">ลำพูน</option>
                                                      <option value="148">ศรีสะเกษ</option>
                                                      <option value="149">สกลนคร</option>
                                                      <option value="150">สงขลา</option>
                                                      <option value="151">สตูล</option>
                                                      <option value="152">สมุทรปราการ</option>
                                                      <option value="153">สมุทรสงคราม</option>
                                                      <option value="154">สมุทรสาคร</option>
                                                      <option value="155">สระบุรี</option>
                                                      <option value="156">สระแก้ว</option>
                                                      <option value="157">สิงห์บุรี</option>
                                                      <option value="158">สุพรรณบุรี</option>
                                                      <option value="159">สุราษฎร์ธานี</option>
                                                      <option value="160">สุรินทร์</option>
                                                      <option value="161">สุโขทัย</option>
                                                      <option value="162">หนองคาย</option>
                                                      <option value="163">หนองบัวลำภู</option>
                                                      <option value="164">อำนาจเจริญ</option>
                                                      <option value="165">อุดรธานี</option>
                                                      <option value="166">อุตรดิตถ์</option>
                                                      <option value="167">อุทัยธานี</option>
                                                      <option value="168">อุบลราชธานี</option>
                                                      <option value="169">อ่างทอง</option>
                                                      <option value="170">เชียงราย</option>
                                                      <option value="171">เชียงใหม่</option>
                                                      <option value="172">เพชรบุรี</option>
                                                      <option value="173">เพชรบูรณ์</option>
                                                      <option value="174">เลย</option>
                                                      <option value="175">แพร่</option>
                                                      <option value="176">แม่ฮ่องสอน</option>
                                           </select>
                    
                    
                    </div></div>
                    
                 <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">อำเภอ/เขต</label>
                    <select size="1" name="district" id="district">
                    <option value="">เลือกอำเภอ/เขต</option>
                </select>
                </div>  
                
                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">ตำบล/แขวง </label>
                     <select size="1" name="tumbon" id="tumbon">
                    <option value="">เลือกตำบล/แขวง</option>
                    </select>
                </div> 
                
                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">รหัสไปรษณีย์  </label>
                    <input type="text" value="" id="postcode" name="postcode" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset">  
                </div>
                
                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">โทรศัพท์</label>
                    <input type="text" value="" id="tel" name="tel" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset">  
                </div>
                
                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">E-mail </label>
                    <input type="text" value="" id="emailshop" name="emailshop" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset">  
                </div>
                
                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">เวลาทำการ </label>
                    <textarea id="daterange" name="daterange" rows="8" cols="40" class="ui-input-text ui-body-c ui-corner-all ui-shadow-inset"></textarea>
                </div>
                
                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">แผนที่ </label>
                     <div id="maparea" style="width: 100%; display: inline-block; height:200px;"></div>
                     <input type="hidden" name="lat"  id="lat" value="">
                     <input type="hidden" name="lng"  id="lng" value="">
                </div>
                
                <div data-role="fieldcontain" class="ui-field-contain ui-body ui-br">
                    <label for="switch-c" id="switch-c-label" class="ui-slider">รูปภาพ </label>
                    <button data-theme="d" type="button" class="ui-btn-hidden" aria-disabled="false" onclick="capturePhoto()">Take a Photo</button>
<button  data-theme="a" type="button" class="ui-btn-hidden" aria-disabled="false" onclick="getPicture(PictureSourceType.PHOTO_LIBRARY);">Upload a Photo</button>
                    <img id="test_img" name="test_img" >
                </div>
                
               
                    
                </div>
                 <div class="ui-body ui-body-c">
                  <fieldset class="ui-grid-a">
                  <input type="hidden" id="cat" name="cat" value="16"><input type="hidden" id="subcat" name="subcat" value="138"> <input type="hidden" id="userid" name="userid" value="">
                <div class="ui-block-a"><button data-theme="d" type="button" class="ui-btn-hidden" aria-disabled="false">Cancel</button></div>
                <div class="ui-block-b"><button data-theme="a" id="buttonSave" name="buttonSave" onclick="submittoserver()"  type="button" class="ui-btn-hidden" aria-disabled="false">Submit</button></div>
                </fieldset>
                </div>
                </form>    
                </div>

                </div>
                
            </div> 

            </article> 
            
            <footer>  

    </footer>
    </body>
    
</html>